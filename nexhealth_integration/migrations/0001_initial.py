# Generated by Django 3.2.16 on 2022-12-07 21:57

import django.contrib.postgres.fields
import django.db.models.deletion
import django_extensions.db.fields
import phonenumber_field.modelfields
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ("core", "0021_auto_20221114_2028"),
    ]

    operations = [
        migrations.CreateModel(
            name="APIRequest",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("modified_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("id", django_extensions.db.fields.ShortUUIDField(blank=True, editable=False, primary_key=True, serialize=False)),
                ("request_body", models.TextField(blank=True)),
                ("request_headers", models.JSONField(null=True)),
                ("request_method", models.TextField(db_index=True)),
                ("request_path", models.TextField(blank=True, db_index=True)),
                ("request_query_parameters", models.JSONField(null=True)),
                ("request_url", models.TextField(db_index=True)),
                ("request_nh_id", models.PositiveIntegerField(db_index=True, null=True)),
                ("request_nh_location_id", models.PositiveIntegerField(db_index=True, null=True)),
                ("request_nh_resource", models.CharField(db_index=True, max_length=128, null=True)),
                ("request_nh_subdomain", models.CharField(db_index=True, max_length=128, null=True)),
                (
                    "request_status",
                    models.CharField(choices=[("CREATED", "Created"), ("ERROR", "Error"), ("COMPLETED", "Completed")], db_index=True, max_length=16),
                ),
                ("request_error_details", models.TextField(blank=True, null=True)),
                ("response_body", models.TextField(null=True)),
                ("response_headers", models.JSONField(null=True)),
                ("response_nh_code", models.BooleanField(null=True)),
                ("response_nh_count", models.PositiveIntegerField(null=True)),
                ("response_nh_data", models.JSONField(null=True)),
                ("response_nh_description", models.JSONField(null=True)),
                ("response_nh_error", models.JSONField(null=True)),
                ("response_status", models.PositiveSmallIntegerField(db_index=True, null=True)),
                ("response_time_sec", models.FloatField(null=True)),
            ],
            options={
                "get_latest_by": "modified_at",
                "abstract": False,
            },
        ),
        migrations.CreateModel(
            name="Appointment",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("modified_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("id", django_extensions.db.fields.ShortUUIDField(blank=True, editable=False, primary_key=True, serialize=False)),
                ("nh_appointment_type_id", models.PositiveIntegerField(db_index=True, null=True)),
                ("nh_created_at", models.DateTimeField()),
                ("nh_id", models.PositiveIntegerField(db_index=True)),
                ("nh_last_sync_time", models.DateTimeField(null=True)),
                ("nh_location_id", models.PositiveIntegerField(db_index=True)),
                ("nh_operatory_id", models.PositiveIntegerField(db_index=True, null=True)),
                ("nh_patient_id", models.PositiveIntegerField(db_index=True)),
                ("nh_provider_id", models.PositiveIntegerField(db_index=True)),
                ("nh_updated_at", models.DateTimeField(null=True)),
                ("cancelled", models.BooleanField()),
                ("cancelled_at", models.DateTimeField(null=True)),
                ("checked_out", models.BooleanField()),
                ("checked_out_at", models.DateTimeField(null=True)),
                ("checkin_at", models.DateTimeField(null=True)),
                ("confirmed", models.BooleanField()),
                ("confirmed_at", models.DateTimeField(null=True)),
                ("end_time", models.DateTimeField(null=True)),
                ("foreign_id", models.CharField(db_index=True, max_length=255, null=True)),
                ("foreign_id_type", models.CharField(max_length=255, null=True)),
                ("is_guardian", models.BooleanField()),
                ("is_new_clients_patient", models.BooleanField()),
                ("is_past_patient", models.BooleanField()),
                ("misc", models.JSONField(null=True)),
                ("nh_deleted", models.BooleanField()),
                ("note", models.TextField(blank=True, null=True)),
                ("patient_confirmed", models.BooleanField()),
                ("patient_confirmed_at", models.DateTimeField(null=True)),
                ("patient_missed", models.BooleanField()),
                ("provider_name", models.CharField(max_length=255, null=True)),
                ("referrer", models.CharField(max_length=255, null=True)),
                ("sooner_if_possible", models.BooleanField()),
                ("start_time", models.DateTimeField(null=True)),
                ("timezone_offset", models.TextField(blank=True, max_length=128, null=True)),
                ("unavailable", models.BooleanField()),
            ],
        ),
        migrations.CreateModel(
            name="Institution",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("modified_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("id", django_extensions.db.fields.ShortUUIDField(blank=True, editable=False, primary_key=True, serialize=False)),
                ("nh_id", models.PositiveIntegerField(unique=True)),
                ("appointment_types_location_scoped", models.BooleanField(null=True)),
                ("country_code", models.CharField(max_length=3)),
                ("emrs", django.contrib.postgres.fields.ArrayField(base_field=models.CharField(max_length=128), default=list, size=None)),
                ("is_appt_categories_location_specific", models.BooleanField(null=True)),
                ("is_sync_notifications", models.BooleanField(null=True)),
                ("name", models.CharField(db_index=True, max_length=255)),
                ("notify_insert_fails", models.BooleanField(null=True)),
                ("phone_number", phonenumber_field.modelfields.PhoneNumberField(blank=True, db_index=True, max_length=128, null=True, region=None)),
                ("subdomain", models.CharField(db_index=True, max_length=128)),
                (
                    "peerlogic_organization",
                    models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="nexhealth_institutions", to="core.organization"),
                ),
                (
                    "peerlogic_practice",
                    models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="nexhealth_institutions", to="core.practice"),
                ),
            ],
            options={
                "get_latest_by": "modified_at",
                "abstract": False,
            },
        ),
        migrations.CreateModel(
            name="InsurancePlan",
            fields=[
                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name="ID")),
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("modified_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("nh_id", models.PositiveIntegerField(unique=True)),
                ("country_code", models.CharField(max_length=3)),
                ("state", models.CharField(max_length=64, null=True)),
                ("address", models.CharField(max_length=255, null=True)),
                ("address2", models.CharField(max_length=255, null=True)),
                ("city", models.CharField(max_length=255, null=True)),
                ("zip_code", models.CharField(max_length=12, null=True)),
                ("name", models.CharField(max_length=255)),
                ("payer_id", models.CharField(max_length=64)),
                ("group_num", models.CharField(max_length=64)),
                ("employer_name", models.CharField(max_length=255)),
                ("foreign_id", models.CharField(db_index=True, max_length=255, null=True)),
                ("foreign_id_type", models.CharField(max_length=255, null=True)),
            ],
            options={
                "get_latest_by": "modified_at",
                "abstract": False,
            },
        ),
        migrations.CreateModel(
            name="Location",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("modified_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("id", django_extensions.db.fields.ShortUUIDField(blank=True, editable=False, primary_key=True, serialize=False)),
                ("nh_created_at", models.DateTimeField()),
                ("nh_id", models.PositiveIntegerField(db_index=True)),
                ("nh_inactive", models.BooleanField()),
                ("nh_institution_id", models.PositiveIntegerField(db_index=True)),
                ("nh_last_sync_time", models.DateTimeField(null=True)),
                ("nh_updated_at", models.DateTimeField(null=True)),
                ("city", models.CharField(max_length=255, null=True)),
                ("email", models.EmailField(max_length=254, null=True)),
                ("foreign_id", models.CharField(db_index=True, max_length=255, null=True)),
                ("foreign_id_type", models.CharField(max_length=255, null=True)),
                ("insert_appt_client", models.BooleanField(null=True)),
                ("latitude", models.PositiveSmallIntegerField(null=True)),
                ("longitude", models.PositiveSmallIntegerField(null=True)),
                ("map_by_operatory", models.BooleanField(null=True)),
                ("name", models.CharField(db_index=True, max_length=255)),
                ("phone_number", phonenumber_field.modelfields.PhoneNumberField(blank=True, db_index=True, max_length=128, null=True, region=None)),
                ("set_availability_by_operatory", models.BooleanField(null=True)),
                ("state", models.CharField(max_length=64, null=True)),
                ("street_address", models.CharField(max_length=255, null=True)),
                ("street_address_2", models.CharField(max_length=255, null=True)),
                ("tz", models.CharField(max_length=128, null=True)),
                ("zip_code", models.CharField(max_length=12, null=True)),
                (
                    "institution",
                    models.ForeignKey(
                        null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="locations", to="nexhealth_integration.institution"
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="NexHealthPatientLink",
            fields=[
                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name="ID")),
            ],
        ),
        migrations.CreateModel(
            name="Patient",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("modified_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("id", django_extensions.db.fields.ShortUUIDField(blank=True, editable=False, primary_key=True, serialize=False)),
                ("nh_created_at", models.DateTimeField()),
                ("nh_guarantor_id", models.PositiveIntegerField(db_index=True)),
                ("nh_id", models.PositiveIntegerField(db_index=True)),
                ("nh_inactive", models.BooleanField()),
                ("nh_institution_id", models.PositiveIntegerField(db_index=True)),
                ("nh_last_sync_time", models.DateTimeField(null=True)),
                ("nh_updated_at", models.DateTimeField(null=True)),
                ("adjustments", models.JSONField(null=True)),
                ("balance_amount", models.CharField(max_length=32, null=True)),
                ("balance_currency", models.CharField(max_length=3, null=True)),
                ("bio", models.JSONField(null=True)),
                ("charges", models.JSONField(null=True)),
                ("date_of_birth", models.DateField(null=True)),
                ("first_name", models.CharField(max_length=255)),
                ("foreign_id", models.CharField(db_index=True, max_length=255, null=True)),
                ("foreign_id_type", models.CharField(max_length=255, null=True)),
                ("last_name", models.CharField(max_length=255)),
                ("middle_name", models.CharField(max_length=255)),
                ("name", models.CharField(db_index=True, max_length=255)),
                ("payments", models.JSONField(null=True)),
                ("phone_number", phonenumber_field.modelfields.PhoneNumberField(blank=True, db_index=True, max_length=128, null=True, region=None)),
                ("unsubscribe_sms", models.BooleanField(null=True)),
                (
                    "guarantor",
                    models.ForeignKey(null=True, on_delete=django.db.models.deletion.CASCADE, related_name="depdendents", to="nexhealth_integration.patient"),
                ),
                (
                    "institution",
                    models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="patients", to="nexhealth_integration.institution"),
                ),
                (
                    "peerlogic_patients",
                    models.ManyToManyField(related_name="nexhealth_patients", through="nexhealth_integration.NexHealthPatientLink", to="core.Patient"),
                ),
            ],
        ),
        migrations.CreateModel(
            name="Provider",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("modified_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("id", django_extensions.db.fields.ShortUUIDField(blank=True, editable=False, primary_key=True, serialize=False)),
                ("nh_created_at", models.DateTimeField()),
                ("nh_id", models.PositiveIntegerField(db_index=True)),
                ("nh_inactive", models.BooleanField()),
                ("nh_institution_id", models.PositiveIntegerField(db_index=True)),
                ("nh_last_sync_time", models.DateTimeField(null=True)),
                ("nh_updated_at", models.DateTimeField(null=True)),
                ("availabilities", models.JSONField(null=True)),
                ("bio", models.JSONField(null=True)),
                ("phone_number", phonenumber_field.modelfields.PhoneNumberField(blank=True, db_index=True, max_length=128, null=True, region=None)),
                ("date_of_birth", models.DateField(null=True)),
                ("display_name", models.CharField(max_length=255, null=True)),
                ("email", models.EmailField(max_length=254, null=True)),
                ("first_name", models.CharField(max_length=255)),
                ("foreign_id", models.CharField(db_index=True, max_length=255, null=True)),
                ("foreign_id_type", models.CharField(max_length=255, null=True)),
                ("last_name", models.CharField(max_length=255)),
                ("middle_name", models.CharField(max_length=255)),
                ("name", models.CharField(db_index=True, max_length=255)),
                ("npi", models.CharField(db_index=True, max_length=128)),
                (
                    "institution",
                    models.ForeignKey(
                        null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="providers", to="nexhealth_integration.institution"
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="Procedure",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("modified_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("id", django_extensions.db.fields.ShortUUIDField(blank=True, editable=False, primary_key=True, serialize=False)),
                ("nh_appointment_id", models.PositiveIntegerField(db_index=True)),
                ("nh_id", models.PositiveIntegerField(db_index=True)),
                ("nh_patient_id", models.PositiveIntegerField(db_index=True)),
                ("nh_provider_id", models.PositiveIntegerField(db_index=True)),
                ("body_site", models.JSONField(null=True)),
                ("code", models.CharField(db_index=True, max_length=128)),
                ("end_date", models.DateField(null=True)),
                ("fee_amount", models.CharField(max_length=32, null=True)),
                ("fee_currency", models.CharField(max_length=3, null=True)),
                ("name", models.CharField(db_index=True, max_length=255)),
                ("start_date", models.DateField(null=True)),
                ("status", models.CharField(max_length=32)),
                (
                    "appointment",
                    models.ForeignKey(
                        null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="procedures", to="nexhealth_integration.appointment"
                    ),
                ),
                (
                    "patient",
                    models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="procedures", to="nexhealth_integration.patient"),
                ),
                (
                    "provider",
                    models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="procedures", to="nexhealth_integration.provider"),
                ),
            ],
        ),
        migrations.AddField(
            model_name="patient",
            name="providers",
            field=models.ManyToManyField(related_name="patients", through="nexhealth_integration.Appointment", to="nexhealth_integration.Provider"),
        ),
        migrations.AddField(
            model_name="nexhealthpatientlink",
            name="nh_patient",
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to="nexhealth_integration.patient"),
        ),
        migrations.AddField(
            model_name="nexhealthpatientlink",
            name="peerlogic_patient",
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to="core.patient"),
        ),
        migrations.CreateModel(
            name="LocationProvider",
            fields=[
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("modified_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("id", django_extensions.db.fields.ShortUUIDField(blank=True, editable=False, primary_key=True, serialize=False)),
                ("nh_location_id", models.PositiveIntegerField()),
                ("nh_provider_id", models.PositiveIntegerField()),
                ("is_bookable", models.BooleanField(null=True)),
                ("location", models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to="nexhealth_integration.location")),
                ("provider", models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to="nexhealth_integration.provider")),
            ],
        ),
        migrations.AddField(
            model_name="location",
            name="patients",
            field=models.ManyToManyField(related_name="locations", through="nexhealth_integration.Appointment", to="nexhealth_integration.Patient"),
        ),
        migrations.AddField(
            model_name="location",
            name="peerlogic_practice",
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="nexhealth_locations", to="core.practice"),
        ),
        migrations.AddField(
            model_name="location",
            name="providers",
            field=models.ManyToManyField(related_name="locations", through="nexhealth_integration.LocationProvider", to="nexhealth_integration.Provider"),
        ),
        migrations.CreateModel(
            name="InsuranceCoverage",
            fields=[
                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name="ID")),
                ("created_at", models.DateTimeField(auto_now_add=True, db_index=True)),
                ("modified_at", models.DateTimeField(auto_now=True, db_index=True)),
                ("nh_id", models.PositiveIntegerField(db_index=True)),
                ("nh_insurance_plan_id", models.PositiveIntegerField(db_index=True)),
                ("nh_patient_id", models.PositiveIntegerField(db_index=True)),
                ("effective_date", models.DateField()),
                ("expiration_date", models.DateField()),
                ("priority", models.PositiveSmallIntegerField()),
                ("subscriber_num", models.CharField(max_length=128)),
                ("subscription_relation", models.CharField(max_length=128)),
                (
                    "insurance_plan",
                    models.ForeignKey(
                        null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="insurance_coverages", to="nexhealth_integration.insuranceplan"
                    ),
                ),
                (
                    "patient",
                    models.ForeignKey(
                        null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="insurance_coverages", to="nexhealth_integration.patient"
                    ),
                ),
            ],
        ),
        migrations.AddField(
            model_name="appointment",
            name="location",
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="appointments", to="nexhealth_integration.location"),
        ),
        migrations.AddField(
            model_name="appointment",
            name="patient",
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="appointments", to="nexhealth_integration.patient"),
        ),
        migrations.AddField(
            model_name="appointment",
            name="provider",
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name="appointments", to="nexhealth_integration.provider"),
        ),
        migrations.AddConstraint(
            model_name="provider",
            constraint=models.UniqueConstraint(fields=("nh_id", "nh_institution_id"), name="nh_unique_provider_with_institution"),
        ),
        migrations.AddConstraint(
            model_name="procedure",
            constraint=models.UniqueConstraint(fields=("nh_id", "nh_appointment_id"), name="nh_unique_procedure_with_appointment"),
        ),
        migrations.AddConstraint(
            model_name="patient",
            constraint=models.UniqueConstraint(fields=("nh_id", "nh_institution_id"), name="nh_unique_patient_with_institution"),
        ),
        migrations.AddConstraint(
            model_name="nexhealthpatientlink",
            constraint=models.UniqueConstraint(fields=("nh_patient_id", "peerlogic_patient_id"), name="nh_unique_patient_with_peerlogic_patient"),
        ),
        migrations.AddConstraint(
            model_name="locationprovider",
            constraint=models.UniqueConstraint(fields=("nh_location_id", "nh_provider_id"), name="nh_unique_provider_with_location"),
        ),
        migrations.AddConstraint(
            model_name="location",
            constraint=models.UniqueConstraint(fields=("nh_id", "nh_institution_id"), name="nh_unique_location_with_institution"),
        ),
        migrations.AddConstraint(
            model_name="insurancecoverage",
            constraint=models.UniqueConstraint(fields=("nh_id", "nh_patient_id"), name="nh_unique_insurance_coverage_with_patient"),
        ),
        migrations.AddConstraint(
            model_name="appointment",
            constraint=models.UniqueConstraint(fields=("nh_id", "nh_location_id"), name="nh_unique_appointment_with_location"),
        ),
    ]
